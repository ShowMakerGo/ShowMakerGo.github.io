import{_ as a}from"./button.37ee0c5d.js";/* empty css              */import{_ as s}from"./cell.b00ee112.js";/* empty css              */import{D as e,G as t,E as l,Y as n,d as o,a4 as u,y as r,J as i,K as d,T as m,r as c,o as v,c as f,w as p,j as y,O as _,a as h,b as g,F as b,l as $,N as x,k as j,q as w,Q as D,i as B,R as C,P as I,_ as N,g as k,h as q}from"./index-9a4aa426.js";import{u as E}from"./useSelectorQuery.5ef6b069.js";const S={...e,danmu:t([]),frequency:l(500),speeds:l(5e3),rows:l(3),top:l(10),loop:n},T=`${C}-barrage`,G=o({name:T,options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),O=N(o({...G,props:S,setup(a,{expose:s}){const e=a;s({add:function(a){N.value=[...N.value,a],Q()}});const t=I(),{getSelectorNodeInfo:l}=E(t),n=(new Date).getTime(),o=!!u().default,C=r((new Date).getTime()),N=r(e.danmu),k=r(e.rows),q=r(e.top),S=e.speeds,G=i((()=>D(e,T,{[`hs-barrage--dmBody${C.value}`]:!0})));function O(a){setTimeout((async()=>{let s=100;const t=await l(`.hs-barrage--dmBody${C.value}`);s=(null==t?void 0:t.width)||300;const n=await l(`.hs-barrage__item${a}`),u=null==n?void 0:n.height,r=a%k.value*(u+q.value)+20+"px";!function(a,s,t){var l;const n=a-k.value>0?a-k.value:0,u=F,r=u[n]?Number(u[n]["--time"]):0,i={top:s,"--time":`${e.frequency*a+r}`,animationDuration:`${S}ms`,animationIterationCount:`${e.loop?"infinite":1}`,animationDelay:`${e.frequency*a+r}ms`,"--move-distance":`-${t}px`};if(o&&(null==(l=N.value[a])?void 0:l.el)){const s=N.value[a].el.style;N.value[a].el.style=Object.assign(s,i)}else F.push(i)}(a,r,s)}),500)}function Q(){N.value.forEach(((a,s)=>{O(s)}))}d((()=>{var a;if(o){const s=document.getElementsByClassName(`hs-barrage__slotBody${n}`)[0].getElementsByClassName("hs-barrage__item"),e=(null==(a=null==s?void 0:s[0])?void 0:a.children)||[];N.value=e}Q()})),m((()=>e.danmu),(a=>{N.value=[...a]}));const F=c([]);return(a,s)=>{const e=B;return v(),f(e,{class:_(G.value),style:x(a.customStyle)},{default:p((()=>[y("div",null,[y("div",{class:_([`hs-barrage__slotBody${h(n)}`])},[(v(!0),g(b,null,$(N.value,((a,s)=>(v(),f(e,{key:`danmu${s}`,class:_(["hs-barrage__item move",[`hs-barrage__item${s}`]]),style:x(F[s])},{default:p((()=>[j(w(a.length>8?`${a.substr(0,8)}...`:a),1)])),_:2},1032,["class","style"])))),128))],2)])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-1422a1c1"]]);const Q=N({setup(){const a=r(""),s=r(null),e=r(["画美不看","不明觉厉","喜大普奔","男默女泪","累觉不爱","爷青结"]);return{inputVal:a,danmu:s,list:e,addDanmu:function(){const a=Math.random();s.value.add(`随机——${String(a).substr(2,10)}`)}}}},[["render",function(e,t,l,n,o,u){const r=O,i=s,d=a,m=k("layout-default-uni");return v(),f(m,null,{default:p((()=>[y("div",{class:"demo barrage-demo h-100vh!"},[y("h2",{class:"title"}," 基础用法 "),q(i,{"custom-class":"danmu-box"},{default:p((()=>[q(r,{ref:"danmu",danmu:n.list},null,8,["danmu"])])),_:1}),y("div",{class:"test"},[q(d,{"custom-class":"add hs-button--primary",onClick:n.addDanmu},{default:p((()=>[j(" 随机添加 ")])),_:1},8,["onClick"])])])])),_:1})}],["__scopeId","data-v-5e71a48e"]]);export{Q as default};
