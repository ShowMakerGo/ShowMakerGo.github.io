import{D as e,E as t,G as a,H as i,d as s,y as n,J as l,r as o,K as c,$ as u,L as r,M as d,o as m,b as g,j as h,N as f,c as p,v,F as b,l as x,O as C,P as k,Q as y,m as T,R as z,_ as w,w as $,g as M,h as E}from"./index-9a4aa426.js";const L={...e,defaultClaw:{type:String,default:"https://img14.360buyimg.com/imagetools/jfs/t1/146467/34/22553/4178/61b088afE198f676e/21952e7018d1d141.png"},activeClaw:{type:String,default:"https://img13.360buyimg.com/imagetools/jfs/t1/218082/28/7092/15914/61b088afEf9c253f7/8392e2b14bd8f43a.png"},speed:t(20),prizeList:a([]),prizeIndex:t(-1)},j={[i]:()=>!0,startTurns:()=>!0,endTurns:()=>!0},I=`${z}-doll-machine`,P=s({name:I,options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),R=w(s({...P,props:L,emits:j,setup(e,{emit:t}){const a=e,i=t,s=k(),z=n(),w=n(),$=n(),M=l((()=>y(a,I))),E=o({left:"50%",marginLeft:"0"});function L(){E.left="50%";const e=$.value.width;E.marginLeft=`-${e/2}px`}function j(e){E.marginLeft="0","left"!==e&&"right"!==e||function(e){const t=r().in(s);t.select(".machine-box").boundingClientRect(),t.select(".machine-tools").boundingClientRect(),t.exec((t=>{w.value=t[0],$.value=t[1],setTimeout((()=>{const t=$.value.left,a=w.value.width-$.value.width;if("left"===e&&0===t||"right"===e&&t===a)return!1;const i=t+("left"===e?-30:30);E.left="left"===e?`${i<0?0:i}px`:`${i>a?a:i}px`}),200)}))}(e)}const P=n({"background-image":`url(${a.defaultClaw})`,"background-size":"100% 100%","background-position":"center","background-repeat":"no-repeat"}),R=n(),_=n(),S=n(),J=n(!1),O=n(!1),D=n({height:"20px"});function G(){i("startTurns"),z.value="",J.value=!0,O.value=!0,P.value["background-image"]=`url(${a.activeClaw})`;const e=w.value.height,t=$.value.height,s=S.value.height;D.value.height=e-s-t-20+"px"}function H(){D.value.height="20px"}function Y(){const e=r().in(s);e.select(".machine-rope").boundingClientRect(),e.exec((e=>{R.value=e[0],O.value=!1,20===R.value.height&&(J.value=!1,i("endTurns")),P.value["background-image"]=`url(${a.defaultClaw})`,z.value=a.prizeList[a.prizeIndex].imagePath,setTimeout((()=>{H()}),200)}))}const F=o([]);function K(){const e=Math.floor(325*Math.random()),t=Math.floor(80*Math.random()+70),a=Math.floor(90*Math.random());F.push({left:`${e}px`,top:`${t}px`,transform:`rotate(${a}deg)`})}function N(){z.value="",L(),H()}return c((()=>{u("dollMachineMounted",(()=>{const e=r().in(s);e.select(".machine-box").boundingClientRect(),e.select(".machine-tools").boundingClientRect(),e.select(".machine-operate").boundingClientRect(),e.select(".machine-rope").boundingClientRect(),e.exec((e=>{w.value=e[0],$.value=e[1],S.value=e[2],R.value=e[3],setTimeout((()=>{L()}),300)}))})),d("dollMachineMounted")})),(e,t)=>{const a=T;return m(),g("div",{class:C(M.value),style:f(e.customClass)},[h("div",{class:"machine-box"},[h("div",{class:"machine-tools",style:f(E)},[h("div",{id:"machine-rope",class:"machine-rope",style:f(D.value),onTransitionend:Y,"on:webkitTransitionEnd":Y},null,36),h("div",{ref_key:"machineClawDom",ref:_,class:"machine-claw",style:f(P.value)},[z.value?(m(),p(a,{key:0,src:z.value,alt:"加载失败",class:"gift-prize"},null,8,["src"])):v("",!0)],4)],4),h("div",{class:"machine-gift-box"},[h("div",{class:"box-glass"},[(m(!0),g(b,null,x(e.prizeList,((e,t)=>(m(),p(a,{id:`gift${t}`,key:t,ref_for:!0,ref:K,src:e.imagePath,class:"gift-img",style:f(F[t]),onLoad:K},null,8,["id","src","style"])))),128))]),h("div",{class:"machine-operate"},[h("div",{class:C(["machine-direction",[J.value?"disabledClick":""]])},[h("span",{class:"direction-block direction-block-left",onClick:t[0]||(t[0]=e=>j("left"))}),h("span",{class:"direction-block direction-block-right",onClick:t[1]||(t[1]=e=>j("right"))})],2),h("div",{class:C(["machine-btn",[J.value?"machine-disabled disabledClick":"machine-start"]]),onClick:G},null,2),h("div",{class:C(["machine-reset-btn",[O.value?"disabledClick":""]]),onClick:N}," 重置 ",2)])])])],6)}}}),[["__scopeId","data-v-4397e454"]]);const _=w({props:{},setup:()=>({prizeList:o([{imagePath:"https://img11.360buyimg.com/imagetools/jfs/t1/147182/12/2440/6194/5f06cde6Ead240fe8/31082e30a182a5ce.png",text:"大鸡腿"},{imagePath:"https://img12.360buyimg.com/imagetools/jfs/t1/221361/4/7410/16458/61c9261eE45802396/27b64caa9e7c9bac.png",text:"JOY"},{imagePath:"https://img11.360buyimg.com/imagetools/jfs/t1/128607/26/6643/6790/5f06cd27E9b5e15f7/7509bc7ce2da66b8.png",text:"VIP"},{imagePath:"https://img12.360buyimg.com/imagetools/jfs/t1/221361/4/7410/16458/61c9261eE45802396/27b64caa9e7c9bac.png",text:"JOY"}]),prizeIndex:n(0),startTurns:()=>{console.log("开始抽奖")},endTurns:()=>{console.log("抽奖结束")}})},[["render",function(e,t,a,i,s,n){const l=R,o=M("layout-default-uni");return m(),p(o,null,{default:$((()=>[h("div",{class:"demo h-100vh!"},[h("h2",{class:"title"}," 基础用法 "),h("div",{class:"show-demo"},[E(l,{"prize-list":i.prizeList,"prize-index":i.prizeIndex,onStartTurns:i.startTurns,onEndTurns:i.endTurns},null,8,["prize-list","prize-index","onStartTurns","onEndTurns"])])])])),_:1})}],["__scopeId","data-v-e2f068b2"]]);export{_ as default};
