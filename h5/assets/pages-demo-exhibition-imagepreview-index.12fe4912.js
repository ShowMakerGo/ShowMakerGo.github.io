import{_ as e}from"./cell.b00ee112.js";/* empty css              */import{D as s,G as o,Y as a,E as t,a5 as i,S as n,aj as l,a0 as c,d as r,r as p,J as m,T as u,K as g,o as h,c as d,w as f,h as v,O as w,N as b,b as y,F as j,l as x,C as P,v as C,k as _,q as k,x as F,Q as T,m as D,bb as E,bc as I,i as L,R as S,_ as Y,t as B,g as X,j as N}from"./index-9a4aa426.js";import{_ as Q}from"./popup.ce3c8dc4.js";import{_ as V,a as z}from"./swiperitem.0529da40.js";import{f as M}from"./interceptor.408c518b.js";import"./transition.47a8b3f2.js";import"./overlay.65ef5d67.js";import"./raf.db71c386.js";import"./useTouch.ef102360.js";import"./useProvide.92abce79.js";import"./useRect.14507623.js";import"./useSelectorQuery.5ef6b069.js";import"./useInject.f710a5e3.js";const O={...s,show:Boolean,scale:Boolean,images:o([]),contentClose:a,initNo:t(0),paginationVisible:Boolean,paginationColor:i("#fff"),autoplay:n(3e3),showIndex:a,closeable:Boolean,closeIconPosition:i("top-right"),beforeClose:Function,isLoop:a},U={[l]:()=>!0,change:e=>c(e),longPress:e=>e instanceof Object},$=`${S}-image-preview`,q=r({name:$,options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),A=Y(r({...q,props:O,emits:U,setup(e,{emit:s}){const o=e,a=s,t=p({showPop:!1,active:0,options:{muted:!0,controls:!0},eleImg:null,store:{scale:1,moveable:!1,originScale:1,oriDistance:1},lastTouchEndTime:0}),i=m((()=>{const e={};return"top-right"===o.closeIconPosition?e.right="10px":e.left="10px",e})),n=m((()=>T(o,$)));function c(e){e!==t.active&&(t.active=e,a("change",t.active))}function r(){o.contentClose&&S()}function S(){M(o.beforeClose,{args:[t.active],done:()=>(t.showPop=!1,t.store.scale=1,B(),void a(l))})}function Y(e,s){return Math.hypot(Math.abs(s.x-e.x),Math.abs(s.y-e.y))}function B(){null!=t.eleImg&&(t.eleImg.style.transform=`scale(${t.store.scale})`)}function X(e){if((new Date).getTime()-t.lastTouchEndTime<300){const e=t.store;e.scale>1?e.scale=1:1===e.scale&&(e.scale=2),B()}const s=e.touches,o=s[0],a=s[1],i=t.store;i.moveable=!0,a&&(i.oriDistance=Y({x:o.pageX,y:o.pageY},{x:a.pageX,y:a.pageY})),i.originScale=i.scale||1}function N(e){if(!t.store.moveable)return;const s=t.store,o=e.touches,a=o[0],i=o[1];if(i){const e=Y({x:a.pageX,y:a.pageY},{x:i.pageX,y:i.pageY})/s.oriDistance;s.scale=s.originScale*e,s.scale>3&&(s.scale=3),B()}}function O(){t.lastTouchEndTime=(new Date).getTime();const e=t.store;e.moveable=!1,(e.scale<1.1&&e.scale>1||e.scale<1)&&(e.scale=1,B())}function U(e){a("longPress",e)}return u((()=>o.show),(e=>{t.showPop=e,e&&(c(o.initNo),document.addEventListener("touchmove",N),document.addEventListener("touchend",O),document.addEventListener("touchcancel",O))})),u((()=>o.initNo),(e=>{e!==t.active&&c(e)})),g((()=>{c(o.initNo)})),(e,s)=>{const o=D,a=E,l=I,p=L;return h(),d(Q,{visible:t.showPop,"onUpdate:visible":s[0]||(s[0]=e=>t.showPop=e),"lock-scroll":!0,"pop-class":"hs-image-preview-custom-pop"},{default:f((()=>[v(p,{class:w(n.value),style:b(e.customStyle),onTouchstartCapture:X},{default:f((()=>[t.showPop?(h(),d(V,{key:0,"auto-play":e.autoplay,"custom-class":"hs-image-preview-swiper",loop:e.isLoop,"is-prevent-default":!1,direction:"horizontal","init-page":e.initNo,"pagination-visible":e.paginationVisible,"pagination-color":e.paginationColor,onChange:c},{default:f((()=>[(h(!0),y(j,null,x(e.images,((s,t)=>(h(),d(z,{key:t},{default:f((()=>[v(l,{class:"hs-image-movable-area"},{default:f((()=>[v(a,{disabled:!e.scale,inertia:"","scale-area":"",class:"hs-image-preview-img",scale:e.scale,direction:"all"},{default:f((()=>[v(o,{mode:"aspectFit",src:s.src,class:"hs-image-preview-img",onLongPress:e=>U(s),onLongTap:e=>U(s),onClick:P(r,["stop"])},null,8,["src","onLongPress","onLongTap"])])),_:2},1032,["disabled","scale"])])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["auto-play","loop","init-page","pagination-visible","pagination-color"])):C("",!0)])),_:1},8,["class","style","onTouchstartCapture"]),e.showIndex?(h(),d(p,{key:0,class:"hs-image-preview-index"},{default:f((()=>[_(k(t.active+1)+" / "+k(e.images.length),1)])),_:1})):C("",!0),e.closeable?(h(),d(p,{key:1,class:"hs-image-preview-close-icon",style:b(i.value),onClick:S},{default:f((()=>[v(F,{name:"circle-close","custom-color":"#ffffff"})])),_:1},8,["style"])):C("",!0)])),_:1},8,["visible"])}}}),[["__scopeId","data-v-9f4eb1cf"]]);const J=Y({setup(){const e=p({showPreview1:!1,showPreview2:!1,showPreview3:!1,showPreview4:!1,imgData:[{src:"https://fastly.jsdelivr.net/npm/@vant/assets/apple-4.jpeg"},{src:"https://m.360buyimg.com/mobilecms/s750x366_jfs/t1/18629/34/3378/144318/5c263f64Ef0e2bff0/0d650e0aa2e852ee.jpg"},{src:"https://m.360buyimg.com/mobilecms/s750x366_jfs/t1/26597/30/4870/174583/5c35c5d2Ed55eedc6/50e27870c25e7a82.png"},{src:"https://m.360buyimg.com/mobilecms/s750x366_jfs/t1/9542/17/12873/201687/5c3c4362Ea9eb757d/60026b40a9d60d85.jpg"}],videoData:[{source:{src:"https://storage.jd.com/about/big-final.mp4?Expires=3730193075&AccessKey=3LoYX1dQWa6ZXzQl&Signature=ViMFjz%2BOkBxS%2FY1rjtUVqbopbJI%3D",type:"video/mp4"},options:{muted:!0,controls:!0}},{source:{src:"https://storage.jd.com/about/big-final.mp4?Expires=3730193075&AccessKey=3LoYX1dQWa6ZXzQl&Signature=ViMFjz%2BOkBxS%2FY1rjtUVqbopbJI%3D",type:"video/mp4"},options:{muted:!0,controls:!0}}]});return{...B(e),showFn:s=>{e[`showPreview${s}`]=!0},hideFn:s=>{e[`showPreview${s}`]=!1}}}},[["render",function(s,o,a,t,i,n){const l=A,c=e,r=X("layout-default-uni");return h(),d(r,null,{default:f((()=>[N("div",{class:"demo h-100vh!"},[N("h2",{class:"title"}," 基础用法 "),v(l,{show:s.showPreview1,images:s.imgData,"is-loop":!1,onClose:o[0]||(o[0]=e=>t.hideFn(1))},null,8,["show","images"]),v(c,{"is-link":"",title:"展示图片预览","show-icon":!0,onClick:o[1]||(o[1]=e=>t.showFn(1))}),N("h2",{class:"title"}," 设置初始页码 "),v(l,{show:s.showPreview2,images:s.imgData,"init-no":3,onClose:o[2]||(o[2]=e=>t.hideFn(2))},null,8,["show","images"]),v(c,{"is-link":"",title:"设置初始页码","show-icon":!0,onClick:o[3]||(o[3]=e=>t.showFn(2))}),N("h2",{class:"title"}," 设置轮播指示器及颜色 "),v(l,{show:s.showPreview3,images:s.imgData,"pagination-visible":!0,"pagination-color":"red",onClose:o[4]||(o[4]=e=>t.hideFn(3))},null,8,["show","images"]),v(c,{"is-link":"",title:"设置轮播指示器及颜色","show-icon":!0,onClick:o[5]||(o[5]=e=>t.showFn(3))})])])),_:1})}]]);export{J as default};
