import{D as e,E as t,H as s,d as a,r,J as l,y as n,T as i,K as o,o as u,c,w as d,h as p,N as m,O as g,a as f,b,F as h,l as y,k as z,q as v,v as T,Q as x,U as k,V as I,W as N,i as j,m as w,R as E,P as _,_ as C,B as S,g as W,j as B}from"./index-9a4aa426.js";import{i as L,a as O}from"./env.43007fb8.js";const $={...e,width:{required:!0,default:"300px"},height:{required:!0,default:"300px"},prizeList:{type:Array,required:!0,default:()=>[]},prizeIndex:t(-1),turnsNumber:t(5),styleOpt:{default:()=>({prizeBgColors:["rgb(255, 231, 149)","rgb(255, 247, 223)","rgb(255, 231, 149)","rgb(255, 247, 223)","rgb(255, 231, 149)","rgb(255, 247, 223)"],borderColor:"#ff9800"})},turnsTime:t(5),lockTime:t(0),pointerStyle:{default:()=>({width:"80px",height:"80px",backgroundImage:'url("https://img11.360buyimg.com/imagetools/jfs/t1/89512/11/15244/137408/5e6f15edEf57fa3ff/cb57747119b3bf89.png")',backgroundSize:"contain",backgroundRepeat:"no-repeat"})}},q={[s]:()=>!0,startTurns:()=>!0,endTurns:()=>!0,lockTurns:()=>!0},M=`${E}-turntable`,P=a({name:M,options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),D=C(a({...P,props:$,emits:q,setup(e,{expose:t,emit:s}){const a=e,E=s,C=_();t({rotateTurn:function(){A.value=!0,G.value=!0,setTimeout((()=>{!function(e){const t=q,s=J.value+360*B+360-(180/F.length+360/F.length*e)-J.value%360;J.value=s,K.value=`rotate(${s}deg)`,Q.value=`transform ${t}s cubic-bezier(0.250, 0.460, 0.455, 0.995)`,setTimeout((()=>{E("endTurns"),G.value=!1,setTimeout((()=>{A.value=!1}),1e3*D)}),1e3*t+500)}(a.prizeIndex)}),300)}});const{width:S,height:W,turnsNumber:B,styleOpt:$,turnsTime:q,pointerStyle:P,lockTime:D}=r(a);let F=r(null==a?void 0:a.prizeList);const R=l((()=>x(a,M))),H=l((()=>k(a,{width:S,height:W}))),A=n(!1),G=n(!1),J=n(0),K=n("0"),Q=n(""),U=n(null),V=n(null),X=n();function Y(e,t){return{transform:`rotate(${360/F.length*e+180/F.length}deg)${"canvas"===t&&O?" scale(2)":""}`}}function Z(){const e=$,t=F.length,{prizeBgColors:s}=e,a=I("canvasWx",C.proxy),r=Number.parseFloat(S),l=L?1:2,n=Number.parseFloat(W)/l;L&&(a.translate(0,n),a.rotate(-90*Math.PI/180));const i=2*Math.PI/t;for(let o=0;o<t;o++){const e=o*i,t=(o+1)*i;a.beginPath(),a.moveTo(r/2,n/2),a.arc(r/2,n/2,n/2,e,t,!1),F[o].prizeColor?a.fillStyle=F[o].prizeColor:a.fillStyle=s[o],a.fill()}a.draw()}function ee(){if(A.value&&(G.value||E("lockTurns"),1))return!1;E("startTurns")}return n(360/F.length),i((()=>a.prizeList),(e=>{F=e,Z()})),o((()=>{setTimeout((()=>{const e=document.getElementById("canvasWx");X.value=e,Z()}),800)})),(e,t)=>{const s=N,a=j,r=w;return u(),c(a,{ref_key:"turntableDom",ref:U,class:g(R.value),style:m(H.value)},{default:d((()=>[p(a,{class:"turntable",style:m({transform:K.value,transition:Q.value})},{default:d((()=>[p(s,{id:"canvasWx",ref_key:"canvasDom",ref:V,type:"2d",class:g(f(L)?"":"mlcanvas"),"canvas-id":"canvasWx",style:m(f(L)?"":Y(0,"canvas"))},null,8,["class","style"]),f(F).length>0?(u(),c(a,{key:0,class:"prize"},{default:d((()=>[(u(!0),b(h,null,y(f(F),((e,t)=>(u(),c(a,{key:t,class:"item",style:m(Y(t))},{default:d((()=>[p(a,{class:"drawTable-name"},{default:d((()=>[z(v(e.prizeName),1)])),_:2},1024),p(a,{class:"drawTable-img"},{default:d((()=>[p(r,{src:e.prizeImg},null,8,["src"])])),_:2},1024)])),_:2},1032,["style"])))),128))])),_:1})):T("",!0)])),_:1},8,["style"]),p(a,{class:"pointer",style:m(f(P)),onClick:ee},null,8,["style"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-ae511de1"]]);const F=C({setup(){const e=n(),t=n("300px"),s=n("300px"),a=n([{id:"xiaomi",prizeName:"小米手机",prizeImg:"https://img14.360buyimg.com/imagetools/jfs/t1/104165/34/15186/96522/5e6f1435E46bc0cb0/d4e878a15bfd9362.png"},{id:"blue",prizeColor:"rgb(251, 219, 216)",prizeName:"蓝牙耳机",prizeImg:"https://img13.360buyimg.com/imagetools/jfs/t1/91864/11/15108/139003/5e6f146dE1c7b511d/1ddc5aa6e502060a.jpg"},{id:"apple",prizeName:"apple watch",prizeImg:"https://img11.360buyimg.com/imagetools/jfs/t1/105385/19/15140/111093/5e6f1506E48bd0dfb/829a98a8cdb4c27f.png"},{id:"fruit",prizeColor:"rgba(246, 142, 46, 0.5)",prizeName:"迪士尼苹果",prizeImg:"https://img11.360buyimg.com/imagetools/jfs/t1/108308/11/8890/237603/5e6f157eE489cccf1/26e0437cfd93b9c8.png"},{id:"fish",prizeName:"海鲜套餐",prizeImg:"https://img14.360buyimg.com/imagetools/jfs/t1/90507/38/15165/448364/5e6f15b4E5df0c718/4bd4c3d375eec312.png"},{id:"thanks",prizeName:"谢谢参与",prizeImg:"https://img11.360buyimg.com/imagetools/jfs/t1/96116/38/15085/5181/5e6f15d1E48e31d30/71353b61dff705d4.png"}]),l=n(5),i=n(5),o=r({prizeBgColors:["rgb(255, 231, 149)","rgb(255, 247, 223)","rgb(255, 231, 149)","rgb(255, 247, 223)","rgb(255, 231, 149)","rgb(255, 247, 223)"],borderColor:"#ff9800"}),u=n(-1),c=n(!1),d=n(5);return{turntable:e,luckWidth:t,luckheight:s,pointerStyle:{width:"80px",height:"80px",backgroundImage:'url("https://img11.360buyimg.com/imagetools/jfs/t1/89512/11/15244/137408/5e6f15edEf57fa3ff/cb57747119b3bf89.png")',backgroundSize:"contain",backgroundRepeat:"no-repeat"},prizeList:a,turnsNumber:l,turnsTime:i,styleOpt:o,prizeIndex:u,lock:c,num:d,startTurns:()=>{const t=Math.floor(Math.random()*a.value.length);u.value=t,e.value.rotateTurn()},endTurns:()=>{S({title:"中奖了",icon:"success",duration:2e3})}}}},[["render",function(e,t,s,a,r,l){const n=D,i=W("layout-default-uni");return u(),c(i,null,{default:d((()=>[B("div",{class:"demo h-100vh!"},[B("h2",null,"基础用法"),p(n,{ref:"turntable",class:"turntable",width:a.luckWidth,height:a.luckheight,"prize-list":a.prizeList,"turns-number":a.turnsNumber,"turns-time":a.turnsTime,"prize-index":a.prizeIndex,"style-opt":a.styleOpt,"pointer-style":a.pointerStyle,onStartTurns:a.startTurns,onEndTurns:a.endTurns},null,8,["width","height","prize-list","turns-number","turns-time","prize-index","style-opt","pointer-style","onStartTurns","onEndTurns"])])])),_:1})}]]);export{F as default};
