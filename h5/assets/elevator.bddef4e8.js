import{D as e,S as t,a5 as s,G as a,E as l,a1 as c,a0 as i,d as o,r as n,L as r,J as d,K as _,T as h,t as u,o as p,c as y,w as v,h as x,a as f,N as m,b as g,F as I,l as k,k as K,q as S,O as H,X as w,v as T,C as L,Q as b,av as C,i as Y,a7 as $,ak as G,R as P,P as D,_ as N}from"./index-9a4aa426.js";const O={...e,height:t("200px"),acceptKey:s("title"),indexList:a([]),isSticky:Boolean,spaceHeight:l(23),titleHeight:l(35)},j={clickItem:(e,t)=>c(e)&&t instanceof Object,clickIndex:e=>c(e),change:e=>i(e)},q=`${P}-elevator`,E=o({name:q,options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),M=N(o({...E,props:O,emits:j,setup(e,{expose:t,emit:s}){const a=e,l=s,c=D();t({scrollTo:N});const i=n({anchorIndex:0,codeIndex:0,listHeight:[],listGroup:[],touchState:{y1:0,y2:0},scrollStart:!1,currentIndex:0,query:r(),scrollTop:0,currentData:{},currentKey:"",scrollY:0}),o=d((()=>b(a,q)));async function P(){i.listHeight=[];let e=0;i.listHeight.push(e);try{const t=await Promise.all(i.listGroup.map((async(e,t)=>await function(e){return new Promise((t=>{r().in(c).selectAll(`#elevator__item__${e}`).boundingClientRect((e=>{t(e)})).exec()}))}(t))));t.forEach(((s,a)=>{e+=Math.floor(t[a][0].height),i.listHeight.push(e)}))}catch(t){throw i.listHeight=[0],t}}function N(e){(e||0===e)&&(e<0&&(e=0),e>i.listHeight.length-2&&(e=i.listHeight.length-2),i.codeIndex=e,i.scrollTop=i.listHeight[e])}function O(e){i.scrollStart=!0;const t=(s=e.target).dataset.index?s.dataset.index:"0";var s;const a=e.touches[0];i.touchState.y1=a.pageY,i.anchorIndex=+t,i.codeIndex=+t,N(+t)}function j(e){const t=e.touches[0];i.touchState.y2=t.pageY;const s=(i.touchState.y2-i.touchState.y1)/23|0;i.codeIndex=i.anchorIndex+s,N(i.currentIndex)}function E(){i.scrollStart=!1}function M(e){const t=e.detail.scrollTop,s=i.listHeight;i.scrollY=Math.floor(t);for(let a=0;a<i.listHeight.length-1;a++){const e=s[a],t=s[a+1];if(i.scrollY>=e&&i.scrollY<t)return void(i.currentIndex=a)}}_((async()=>{try{await Promise.all(a.indexList.map((async(e,t)=>{const s=await function(e){return new Promise((t=>{r().in(c).select(`#elevator__item__${e}`).fields({size:!0,scrollOffset:!0,rect:!0,id:!0},(e=>{t(e)})).exec()}))}(t);var a;a=s,C((()=>{i.listGroup.includes(a)||null==a||i.listGroup.push(a)}))}))),P()}catch(e){throw P(),e}})),h((()=>i.currentIndex),(e=>{l("change",e)}));const{scrollTop:R,scrollY:z,currentIndex:A,scrollStart:B,codeIndex:F,currentData:J,currentKey:Q}=u(i);return(e,t)=>{const s=Y,a=$,c=G;return p(),y(s,{class:H(o.value),style:m(e.customStyle)},{default:v((()=>[x(c,{id:"listview",class:"hs-elevator__list hs-elevator__list--mini","scroll-top":f(R),"scroll-y":!0,"scroll-with-animation":!0,"scroll-anchoring":!0,style:m({height:isNaN(+e.height)?e.height:`${e.height}px`}),onScroll:M},{default:v((()=>[x(s,{id:"elevator__item-wrap"},{default:v((()=>[(p(!0),g(I,null,k(e.indexList,((t,c)=>(p(),y(s,{id:[`elevator__item__${c}`],key:t[e.acceptKey],class:"hs-elevator__list__item"},{default:v((()=>[x(s,{class:"hs-elevator__list__item__code"},{default:v((()=>[K(S(t[e.acceptKey]),1)])),_:2},1024),(p(!0),g(I,null,k(t.list,(c=>(p(),y(s,{key:c.id,class:H(["hs-elevator__list__item__name",{"hs-elevator__list__item__name--highcolor":f(J).id===c.id&&f(Q)===t[e.acceptKey]}]),onClick:s=>function(e,t){l("clickItem",e,t),i.currentData=t,i.currentKey=e}(t[e.acceptKey],c)},{default:v((()=>[e.$slots.default?w(e.$slots,"default",{key:1,item:c},void 0,!0):(p(),y(a,{key:0,nodes:c.name},null,8,["nodes"]))])),_:2},1032,["class","onClick"])))),128))])),_:2},1032,["id"])))),128))])),_:3})])),_:3},8,["scroll-top","style"]),x(s,{class:H(["hs-elevator__list__fixed",{"hs-hidden":!(f(z)>2&&e.isSticky)}])},{default:v((()=>[x(s,{class:"hs-elevator__list__fixed-title"},{default:v((()=>[K(S(e.indexList[f(A)][e.acceptKey]),1)])),_:1})])),_:1},8,["class"]),e.indexList.length>0?(p(),y(s,{key:0,class:H(["hs-elevator__code--current",{"hs-hidden":!f(B)}])},{default:v((()=>[K(S(e.indexList[f(F)][e.acceptKey]),1)])),_:1},8,["class"])):T("",!0),x(s,{class:"hs-elevator__bars",onTouchstart:O,onTouchmove:L(j,["stop","prevent"]),onTouchend:E},{default:v((()=>[x(s,{class:"hs-elevator__bars__inner"},{default:v((()=>[(p(!0),g(I,null,k(e.indexList,((t,a)=>{var c,i;return p(),y(s,{key:t[e.acceptKey],class:H(["hs-elevator__bars__inner__item",{active:(null==t?void 0:t[e.acceptKey])===(null==(i=null==(c=e.indexList)?void 0:c[f(A)])?void 0:i[e.acceptKey])}]),"data-index":a,onClick:s=>{return a=t[e.acceptKey],void l("clickIndex",a);var a}},{default:v((()=>[K(S(t[e.acceptKey]),1)])),_:2},1032,["class","data-index","onClick"])})),128))])),_:1})])),_:1},8,["onTouchstart","onTouchmove"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-690cc63d"]]);export{M as _};
