import{D as e,E as n,a5 as t,ad as s,a1 as a,ae as o,r as l,J as c,Q as r,y as i,K as u,af as d,V as v,R as g,P as h,ag as m,d as f,o as p,b as y,j as S,h as x,a as k,w as T,k as H,q as E,O as W,N as C,W as _,_ as b,u as w,c as I,g as U,v as j,m as P}from"./index-9a4aa426.js";import{_ as D}from"./button.37ee0c5d.js";import{u as X}from"./useSelectorQuery.5ef6b069.js";import{u as Y}from"./useTranslate.6f3ff1af.js";const M={...e,lineWidth:n(2),strokeStyle:t("#000"),type:t("png"),unSupportTpl:String},O={start:()=>!0,end:()=>!0,signing:e=>e instanceof Object,[s]:(e,n)=>e instanceof Object&&a(n),[o]:()=>!0},R=`${g}-signature`;function $(e,n){const t=h(),{query:a}=X(t.proxy);let g=l([]);const f=c((()=>r(e,R))),p=i(null),y=`spcanvas${(new Date).getTime()}`,S=l({canvasHeight:0,canvasWidth:0,ctx:null});const x=i(!1);function k(){return new Promise(((a,o)=>{m({canvasId:y,width:S.canvasWidth,height:S.canvasHeight,fileType:e.type,success(e){const t=x.value?S.ctx:"请绘制签名",o=x.value?e.tempFilePath:"";n(s,t,o),a(o)},fail(e){o(e),n(s,e)}},t)}))}return u((()=>{a.select(`#${y}`).fields({size:!0},(e=>{!function(e,n){const s=d().pixelRatio;S.ctx=v(y,t.proxy),S.canvasWidth=e*s,S.canvasHeight=n*s}(e.width,e.height)})).exec()})),{classes:f,spcanvas:p,state:S,canvasSetId:y,componentName:R,startEventHandler:function(t){t.preventDefault();const s={X:t.changedTouches[0].x,Y:t.changedTouches[0].y};g.push(s),n("start"),S.ctx.beginPath(),S.ctx.lineWidth=e.lineWidth,S.ctx.strokeStyle=e.strokeStyle},moveEventHandler:function(e){e.preventDefault(),x.value=!0;const t={X:e.changedTouches[0].x,Y:e.changedTouches[0].y};g.push(t),g.length>=2&&function(){const e=g[0],n=g[1];g.shift(),S.ctx.moveTo(e.X,e.Y),S.ctx.lineTo(n.X,n.Y),S.ctx.stroke(),S.ctx.draw(!0)}(),n("signing",e)},endEventHandler:function(e){e.preventDefault(),g=[],n("end")},leaveEventHandler:function(e){e.preventDefault()},clear:function(){S.ctx.clearRect(0,0,S.canvasWidth,S.canvasHeight),S.ctx.closePath(),S.ctx.draw(!0),n(o),x.value=!1},confirm:function(){k()},onSave:k}}const{translate:q}=Y(R),N=f({name:R,options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),Q=b(f({...N,props:M,emits:O,setup(e,{emit:n}){const t=e,s=n,{classes:a,spcanvas:o,canvasSetId:l,startEventHandler:c,moveEventHandler:r,endEventHandler:i,leaveEventHandler:u,clear:d,confirm:v}=$(t,s);return(e,n)=>{const t=_;return p(),y("div",{class:W(k(a)),style:C(e.customStyle)},[S("div",{class:"hs-signature-inner spcanvas_WEAPP"},[x(t,{id:k(l),ref_key:"spcanvas",ref:o,class:"spcanvas",canvasId:k(l),"disable-scroll":!0,onTouchstart:k(c),onTouchmove:k(r),onTouchend:k(i),onTouchleave:k(u)},null,8,["id","canvasId","onTouchstart","onTouchmove","onTouchend","onTouchleave"])]),x(D,{"custom-class":"hs-signature-btn",type:"default",onClick:n[0]||(n[0]=e=>k(d)())},{default:T((()=>[H(E(k(q)("reSign")),1)])),_:1}),x(D,{"custom-class":"hs-signature-btn",type:"primary",onClick:n[1]||(n[1]=e=>k(v)())},{default:T((()=>[H(E(k(q)("confirm")),1)])),_:1})],6)}}}),[["__scopeId","data-v-4e750bce"]]),{darkMode:z}=w();const A=b({setup(){const e=i(""),n=i("");return{...l({lineWidth:4,strokeStyle:"green",testimg:""}),confirm:(n,t)=>{if(""===t)return console.log(n),!1;e.value=t,console.log("图片地址",n,t)},darkMode:z,clear:()=>{e.value="",console.log("清除事件")},start:()=>{console.log("签名开始")},signing:e=>{console.log("签名进行中",e)},end:()=>{console.log("签名结束")},demoSignUrl:e,demoSignUrl2:n,confirm2:(e,t)=>{if(""===t)return console.log(e),!1;n.value=t,console.log("图片地址",e,t)},clear2:()=>{n.value="",console.log("清除事件")}}}},[["render",function(e,n,t,s,a,o){const l=Q,c=P,r=U("layout-default-uni");return p(),I(r,null,{default:T((()=>[S("div",{class:"demo signature-demo"},[S("h2",{class:"title"}," 基础用法 "),x(l,{"stroke-style":s.darkMode?"white":"#111","custom-class":"test",onConfirm:s.confirm,onClear:s.clear,onStart:s.start},null,8,["stroke-style","onConfirm","onClear","onStart"]),s.demoSignUrl?(p(),I(c,{key:0,src:s.demoSignUrl,class:"demoSignUrl"},null,8,["src"])):j("",!0),S("h2",{class:"title"}," 修改颜色和签字粗细 "),x(l,{"line-width":e.lineWidth,"stroke-style":e.strokeStyle,onConfirm:s.confirm2,onClear:s.clear2,onStart:s.start,onSigning:s.signing,onEnd:s.end},null,8,["line-width","stroke-style","onConfirm","onClear","onStart","onSigning","onEnd"]),s.demoSignUrl2?(p(),I(c,{key:1,src:s.demoSignUrl2,class:"demoSignUrl"},null,8,["src"])):j("",!0)])])),_:1})}],["__scopeId","data-v-1e15ad90"]]);export{A as default};
