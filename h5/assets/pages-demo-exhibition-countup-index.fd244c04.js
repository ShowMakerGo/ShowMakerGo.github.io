import{_ as t}from"./button.37ee0c5d.js";/* empty css              */import{P as e,D as n,E as i,Y as l,a5 as u,ac as r,d as a,J as s,r as o,T as m,b6 as c,K as g,av as d,aI as h,o as p,c as b,w as N,a as _,b as f,F as v,N as y,l as F,k as S,v as x,q as z,O as k,Q as I,i as $,R as P,_ as H,y as E,t as L,g as T,j as M,h as C}from"./index-9a4aa426.js";const Y={...n,initNum:i(0),endNum:i(0),speed:i(1),toFixed:i(0),startFlag:l,during:i(1e3),numWidth:i(20),numHeight:i(20),scrolling:Boolean,customChangeNum:i(1),customBgImg:u(""),customSpacNum:i(0),type:u(""),machinePrizeNum:i(0),machineNum:i(3),machinePrizeLevel:i(0),machineTurnMore:i(0)},w={scrollEnd:t=>r(t)||void 0===t},W=`${P}-countup`,D=a({name:W,options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),j=H(a({...D,props:Y,emits:w,setup(t,{expose:n,emit:i}){const l=t,u=i;n({machineLuck:B});const r=s((()=>I(l,W))),a=o({valFlag:!1,current:0,sortFlag:"add",initDigit1:0,initDigit2:0,to0_10:[0,1,2,3,4,5,6,7,8,9,0],to10_0:[0,9,8,7,6,5,4,3,2,1,1],timer:null,totalCount:0,pointNum:0,numberVal:0,num_total_len:0,relNum:0,customNumber:1,prizeLevelTrun:0,prizeY:[],prizeYPrev:[],finshMachine:0,notPrize:[],typeMachine:""}),{startFlag:P,scrolling:H,customBgImg:E,type:L}=o(l);function T(){if(a.valFlag)return!1;P&&(H||E?"machine"!==L&&D():(!function(){const{endNum:t,initNum:e,speed:n,toFixed:i}=l,r=setInterval((()=>{e>t?a.current<=t||a.current<=n?(a.current=Number(t.toFixed(i)),clearInterval(r),u("scrollEnd"),a.valFlag=!1):a.current=Number((Number.parseFloat(String(a.current))-Number.parseFloat(String(n))).toFixed(i)):a.current>=t?(a.current=Number(t.toFixed(i)),clearInterval(r),u("scrollEnd"),a.valFlag=!1):a.current=Number((Number.parseFloat(String(a.current))+Number.parseFloat(String(n))).toFixed(i))}),l.during)}(),setTimeout((()=>{a.valFlag=!0}),300)))}function M(){clearInterval(Number(a.timer)),a.timer=null}function C(t,e,n){const i=(t.toString().split(".")[1]||"").length,l=(e.toString().split(".")[1]||"").length,u=10**Math.max(i,l);if("-"===n){return Number((t*u-e*u).toFixed(0))/u}return Number((t*u+e*u).toFixed(0))/u}function Y(t){const{num_total_len:e,pointNum:n,initDigit1:i,initDigit2:l,sortFlag:u}=a,r="add"===u||"equal"===u?String(l)[t-(e-n)]:10-Number(String(l)[t-(e-n)]),s="add"===u||"equal"===u?String(i)[t]:10-Number(String(i)[t]);let o=t>e-n-1?100*-r+"%":t<=String(i).length-1?100*-s+"%":0;return"-1000%"===o&&(o=0),o}function w(t){const{num_total_len:e,pointNum:n,initDigit1:i,initDigit2:l,sortFlag:u}=a,r=String(l)[t-(e-n)];return t>e-n-1?r||0:t<=String(i).length-1?String(i)[t]:0}function D(t){let e,n,i,r,{initNum:s,endNum:o,toFixed:m,customBgImg:c}=l;c&&(s=l.customChangeNum),0!==s?(0!==m&&(s=Number(s.toFixed(m))),String(s).includes(".")?(e=String(s).split(".")[0].length,n=String(s).split(".")[1].length):(e=String(s).length,n=0)):(e=1,n=0),0!==o?(0!==m&&(o=Number(o.toFixed(m))),String(o).includes(".")?(i=String(o).split(".")[0].length,r=String(o).split(".")[1].length):(i=String(o).length,r=0)):(i=1,r=0);const g=e>=i?e:i,h=n>=r?n:r;a.num_total_len=g+h,a.pointNum=h,s>o?(a.sortFlag="reduce",a.to0_10=[0,9,8,7,6,5,4,3,2,1,0],a.totalCount=C(s,o,"-"),a.numberVal=Number(String(s))):s<o?(a.sortFlag="add",a.to0_10=[0,1,2,3,4,5,6,7,8,9,0],a.totalCount=C(o,s,"-"),a.numberVal=Number(String(o))):a.sortFlag="equal";let p=1;for(let l=0;l<a.pointNum;l++)p*=10;const b=a.numberVal*p;if(a.relNum=b,0!==m&&(a.pointNum=String(a.numberVal).split(".")[1]?String(a.numberVal).split(".")[1].length:0,a.num_total_len=String(b).length),String(s).includes(".")){const t=String(s).split(".");a.initDigit1=Number(t[0]),a.initDigit2=Number(t[1])}else a.initDigit1=s,a.initDigit2=0;H&&!c?d((()=>{if("equal"===a.sortFlag)return!1;!function(t){M();let e=1;0!==a.pointNum&&(e=1/10**a.pointNum);a.timer=setInterval((()=>{j(t),a.totalCount=C(a.totalCount,e,"-"),a.totalCount<=0&&(M(),u("scrollEnd"),a.valFlag=!1)}),l.during)}(document.getElementsByClassName("hs-countup__number-item")[a.num_total_len-1])})):0!==t&&function(){0!==a.pointNum&&a.pointNum;d((()=>{document.getElementsByClassName("hs-countup__numberimg")[0].addEventListener("webkitTransitionEnd",(()=>{u("scrollEnd"),a.valFlag=!1}))}))}()}function j(t){const e=t.style.all;let n;if(n="add"===a.sortFlag?Number.parseInt(String(e))+1:Number.parseInt(String(e))-1>=0?Number.parseInt(String(e))-1:9,t.style.all=String(n),"none"!==t.style.transition&&1!==n&&t.style.transition||(t.style.transition=`all linear ${l.during}ms`),10===n||"reduce"===a.sortFlag&&0===n){let e=null;t.style.top=`-${"add"===a.sortFlag?100*n:100*(10-n)}%`,t.style.all="0",e=setTimeout((()=>{e&&clearTimeout(e),t.style.transition="none",t.style.top="0",10===n&&t.previousSibling&&j(t.previousSibling)}),.975*l.during)}else t.style.top=`-${"add"===a.sortFlag?100*n:100*(10-n)}%`;"-100%"===t.style.top&&"reduce"===a.sortFlag&&j(t.previousSibling)}function B(){const t=l.machineTurnMore<0?0:l.machineTurnMore,e=l.numHeight*l.machinePrizeNum;a.prizeLevelTrun<0&&function(){for(a.notPrize=[];a.notPrize.length<3;){const t=Math.floor(Math.random()*l.machinePrizeNum+1);a.notPrize.includes(t)||a.notPrize.push(t)}}();for(let n=0;n<l.machineNum;n++)setTimeout((()=>{const i=e*(n+1+Number.parseFloat(String(t)));0!==a.prizeYPrev.length&&(a.prizeY[n]=a.prizeYPrev[n]);const u=a.prizeYPrev[n]?a.prizeYPrev[n]:0;let r=i+u+(l.machinePrizeNum-a.prizeLevelTrun+1)*l.numHeight+(e-u);a.prizeLevelTrun<0&&(r+=l.numHeight*a.notPrize[n]),V(n,r,u)}),500*n)}function V(t,e,n){let i=setInterval((()=>{if(n<=e)n+=10,a.prizeY[t]=Number.parseFloat(String(n));else if(clearInterval(i),i=null,a.finshMachine+=1,a.prizeY[t]=e,a.finshMachine===l.machineNum){const t=l.numHeight*l.machinePrizeNum;a.prizeYPrev=[];c(a.prizeY).forEach((e=>{let n=e;for(;n>t;)n-=t;a.prizeYPrev.push(n)})),setTimeout((()=>{a.finshMachine=0,a.prizeLevelTrun<0?(u("scrollEnd",!1),a.valFlag=!1):(u("scrollEnd",!0),a.valFlag=!1)}),130)}}),30)}return m((()=>l.customChangeNum),((t,e)=>{M(),D(0)})),m((()=>l.machinePrizeLevel),((t,e)=>{a.prizeLevelTrun=t})),m((()=>l.initNum),((t,e)=>{a.current=t,a.valFlag=!1,T()})),m((()=>l.endNum),((t,e)=>{a.current=l.initNum,a.valFlag=!1,T()})),function(t){const n=e();n&&Object.assign(n.proxy,t)}({machineLuck:B}),g((()=>{a.current=l.initNum,d((()=>{T()}))})),h((()=>{M(),a.timer=null})),(t,e)=>{const n=$;return p(),b(n,{class:k(r.value),style:y(t.customStyle)},{default:N((()=>[""!==_(E)?(p(),f(v,{key:0},["machine"===_(L)?(p(),b(n,{key:0,class:"hs-countup__machine",style:y({height:`${t.numHeight}px`})},{default:N((()=>[(p(!0),f(v,null,F(t.machineNum,((e,i)=>(p(),b(n,{key:`mImg${i}`,class:"hs-countup__machine-item",style:y({width:`${t.numWidth}px`,height:`${t.numHeight}px`,background:`url(${_(E)}) `,backgroundPosition:`0 ${a.prizeY[i]}px`})},null,8,["style"])))),128))])),_:1},8,["style"])):(p(),b(n,{key:1,class:"hs-countup__numberimg",style:y({height:`${t.numHeight}px`})},{default:N((()=>[(p(!0),f(v,null,F(a.num_total_len,((e,i)=>(p(),b(n,{key:`cImg${i}`,class:"hs-countup__numberimg__item",style:y({width:`${t.numWidth}px`,height:`${t.numHeight}px`,left:t.numWidth*(i>a.num_total_len-a.pointNum-1?i===a.num_total_len-a.pointNum?1.5*i:1.3*i:i)+"px",backgroundImage:`url(${_(E)})`,backgroundPosition:`0 ${-(+String(a.relNum)[i]*t.numHeight+t.customSpacNum*+String(a.relNum)[i])}px`,transition:`all linear ${t.during/10}ms`})},null,8,["style"])))),128)),a.pointNum>0?(p(),b(n,{key:0,class:"hs-countup-pointstyl",style:y({width:t.numWidth/2+"px",bottom:0,left:t.numWidth*(a.num_total_len-a.pointNum)*1.1+"px",fontSize:"30px"})},{default:N((()=>[S(" . ")])),_:1},8,["style"])):x("",!0)])),_:1},8,["style"]))],64)):(p(),f(v,{key:1},[_(H)?(p(),b(n,{key:0,class:"hs-countup__number",style:y({width:t.numWidth*a.num_total_len+t.numWidth/3+"px",height:`${t.numHeight}px`,lineHeight:`${t.numHeight}px`})},{default:N((()=>[(p(!0),f(v,null,F(a.num_total_len,((e,i)=>(p(),b(n,{key:e,class:"hs-countup__number-item",style:y({all:w(i),top:Y(i),left:t.numWidth*(i>a.num_total_len-a.pointNum-1?1.1*i:i)+"px"}),"turn-number":w(i)},{default:N((()=>[(p(!0),f(v,null,F(a.to0_10,((e,i)=>(p(),b(n,{key:`dote${i}`,class:"hs-countup__number-item__span",style:y({width:`${t.numWidth}px`,height:`${t.numHeight}px`,lineHeight:`${t.numHeight}px`})},{default:N((()=>[S(z(e),1)])),_:2},1032,["style"])))),128))])),_:2},1032,["style","turn-number"])))),128)),a.pointNum>0?(p(),b(n,{key:0,class:"hs-countup-pointstyl",style:y({width:t.numWidth/3+"px",height:`${t.numHeight}px`,lineHeight:`${t.numHeight}px`,top:0,left:t.numWidth*(a.num_total_len-a.pointNum)+"px"})},{default:N((()=>[S(" . ")])),_:1},8,["style"])):x("",!0)])),_:1},8,["style"])):(p(),f(v,{key:1},[S(z(a.current),1)],64))],64))])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-d7620849"]]);const B=H({setup(){const t=o({customNumber:618,bgImage:"https://img10.360buyimg.com/imagetools/jfs/t1/133024/3/2251/2646/5ee7549aE8dc02d7e/de6901b6c72db396.png",startFlag:!1,startFlag2:!1,machineNum:3,bgImage2:"https://img10.360buyimg.com/imagetools/jfs/t1/121466/20/6784/28830/5f06e7f2Edbb8998c/9bdd9e7b24dff9fe.png",prizeLevel:0}),e=E(null);return g((()=>{setInterval((()=>{t.customNumber=Math.floor(601*Math.random()+100)}),5e3)})),{...L(t),scrollAniEnd:e=>{console.log(e?"恭喜中奖！！！":"很遗憾！没有中奖"),setTimeout((()=>{t.startFlag=!1}),300)},startRole:()=>{t.prizeLevel=Math.floor(5*Math.random()+1),console.log(t.prizeLevel,"中奖"),t.startFlag=!0,setTimeout((()=>{e.value.machineLuck()}),500)},startRole2:()=>{t.prizeLevel=-1,console.log(t.prizeLevel,"不中奖"),t.startFlag=!0,setTimeout((()=>{e.value.machineLuck()}),500)},countupMachine:e}}},[["render",function(e,n,i,l,u,r){const a=j,s=t,o=T("layout-default-uni");return p(),b(o,null,{default:N((()=>[M("div",{class:"demo countup-demo h-100vh!"},[M("h2",{class:"title"}," 基础用法 "),M("div",{class:"show-demo"},[C(a,{"init-num":0,"end-num":200}),C(a,{"init-num":150,"end-num":0,speed:6.18,"to-fixed":2}),C(a,{"init-num":500,"end-num":0,speed:17,"to-fixed":2})]),M("h2",{class:"title"}," 自定义滚动图片展示 "),M("div",{class:"show-demo"},[C(a,{"custom-change-num":e.customNumber,"custom-bg-img":e.bgImage,"custom-spac-num":11,"num-width":33,"num-height":47,during:8e3},null,8,["custom-change-num","custom-bg-img"])]),M("h2",{class:"title"}," 抽奖（模拟滚动抽奖） "),M("div",{class:"show-demo"},[C(a,{ref:"countupMachine",type:"machine","machine-num":e.machineNum,"machine-prize-num":5,"machine-prize-level":e.prizeLevel,"custom-bg-img":e.bgImage2,"num-width":100,"num-height":100,during:3e3,onScrollEnd:l.scrollAniEnd},null,8,["machine-num","machine-prize-level","custom-bg-img","onScrollEnd"]),M("div",{class:"btnBtn"},[C(s,{type:"danger",disabled:e.startFlag,onClick:l.startRole},{default:N((()=>[S(" 中奖 ")])),_:1},8,["disabled","onClick"]),C(s,{type:"danger",disabled:e.startFlag,onClick:l.startRole2},{default:N((()=>[S(" 不中奖 ")])),_:1},8,["disabled","onClick"])])])])])),_:1})}],["__scopeId","data-v-dace727d"]]);export{B as default};
