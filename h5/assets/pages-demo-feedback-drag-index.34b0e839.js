import{D as t,a5 as e,d as o,y as s,aT as i,r as a,J as n,af as r,K as l,b4 as u,bd as c,o as d,c as p,w as f,X as m,O as h,N as y,L as v,U as g,i as b,R as x,P as T,_ as P,g as _,j as H,h as L,k as W}from"./index-9a4aa426.js";import{u as j}from"./useRect.14507623.js";import{_ as $}from"./button.37ee0c5d.js";/* empty css              */import{i as D}from"./index.99f72493.js";import"./useSelectorQuery.5ef6b069.js";const k={...t,attract:Boolean,direction:e("all"),boundary:{type:Object,default:()=>({top:0,left:0,right:0,bottom:0})}},w=o({name:`${x}-drag`,options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),A=P(o({...w,props:k,setup(t){const e=t,o=T(),x=s(),P=`myDrag${i()}`,_=a({keepAlive:!1,elWidth:0,elHeight:0,screenWidth:0,screenHeight:0,startTop:0,startLeft:0,initTop:0,initLeft:0,nx:0,ny:0,xPum:0,yPum:0,top:0,left:0,position:{x:0,y:0},boundary:{top:0,left:0,right:0,bottom:0}}),H=n((()=>({"hs-uni-drag":!0,[`${e.customClass}`]:e.customClass}))),L=r();function W(t){if(t.preventDefault(),1===t.touches.length){const o=t.touches[0];_.nx=o.clientX-_.position.x,_.ny=o.clientY-_.position.y,_.xPum=_.startLeft+_.nx,_.yPum=_.startTop+_.ny;const s=_.screenWidth-_.elWidth-_.boundary.right;Math.abs(_.xPum+_.initLeft)>s?_.xPum=s-_.initLeft:_.xPum+_.initLeft<=_.boundary.left&&(_.xPum=_.boundary.left-_.initLeft),_.yPum+_.initTop<_.boundary.top?_.yPum=_.boundary.top-_.initTop:_.yPum+_.initTop>_.screenHeight-_.elHeight-_.boundary.bottom&&(_.yPum=_.screenHeight-_.elHeight-_.boundary.bottom-_.initTop),"y"!==e.direction&&(_.left=_.xPum),"x"!==e.direction&&(_.top=_.yPum)}}function $(t){var e,s,i,a,n,r,l,u,c;const d=v().in(o),p=null==(e=null==t?void 0:t.mpEvent)?void 0:e.currentTarget.id,f=null==(s=null==t?void 0:t.currentTarget)?void 0:s.offsetTop,m=null==(i=null==t?void 0:t.currentTarget)?void 0:i.offsetLeft,h=t.touches[0],y=null==(r=null==(n=null==(a=t.touches[0])?void 0:a.target)?void 0:n.parentNode)?void 0:r.style.top,g=null==(c=null==(u=null==(l=t.touches[0])?void 0:l.target)?void 0:u.parentNode)?void 0:c.style.left;d.selectAll(P).boundingClientRect((t=>{t.forEach((t=>{p&&p===t.id?(_.startTop=t.top-f,_.startLeft=t.left-m):y&&(_.startTop=Number(y.slice(0,-2)),_.startLeft=Number(g.slice(0,-2)))}))})).exec(),_.position.x=h.clientX,_.position.y=h.clientY}l((()=>{setTimeout((()=>{!async function(){const t=await j(P,o);_.elWidth=t.width,_.elHeight=t.height,_.initTop=t.top,_.initLeft=t.left,_.screenWidth=L.screenWidth,_.screenHeight=L.screenHeight}()}),200),_.boundary=e.boundary})),u((()=>{_.keepAlive&&(_.keepAlive=!1)})),c((()=>{_.keepAlive=!0}));const D=n((()=>g(e,{transform:`translate(${_.left}px, ${_.top}px)`,top:`${_.top}px`,left:`${_.left}px`})));return(t,e)=>{const o=b;return d(),p(o,{id:P,ref_key:"myDrag",ref:x,class:h(H.value),style:y(D.value),catchtouchmove:!0,onTouchstart:$,onTouchmove:W},{default:f((()=>[m(t.$slots,"default",{},void 0,!0)])),_:3},8,["class","style","onTouchstart","onTouchmove"])}}}),[["__scopeId","data-v-e1ccfe7d"]]);const N=P({setup:()=>({isH5:D,right:function(){return r().windowWidth-300},bottom:function(){return r().screenHeight-300-320}})},[["render",function(t,e,o,s,i,a){const n=$,r=A,l=_("layout-default-uni");return d(),p(l,null,{default:f((()=>[H("div",{class:"demo h-100vh!",catchtouchmove:"true"},[H("h2",{class:"title"}," 基础用法 "),L(r,{class:"dragDemo"},{default:f((()=>[L(n,{type:"primary"},{default:f((()=>[W(" 触摸移动 ")])),_:1})])),_:1}),H("h2",{class:"title"}," y轴方向移动 "),L(r,{class:"dragDemo",direction:"y"},{default:f((()=>[L(n,{type:"primary"},{default:f((()=>[W(" Y轴移动 ")])),_:1})])),_:1}),H("h2",{class:"title"}," x轴方向移动 "),L(r,{class:"dragDemo",direction:"x"},{default:f((()=>[L(n,{type:"primary"},{default:f((()=>[W(" X轴移动 ")])),_:1})])),_:1})])])),_:1})}],["__scopeId","data-v-aa77e2f5"]]);export{N as default};
